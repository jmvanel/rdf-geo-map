<!doctype html>
<html lang='fr'>

<head>
    <title>Vincennes, from dbPedia.org</title>
    <meta charset="utf-8" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"></script>
    <script src="geo-map.js"></script>
    <script src="http://rdf-ext.bergnet.org/dist/rdf-ext-all-1.0.0.src.js"></script>
    <script src="rdf2array.js"></script>
</head>

<body>
    <div id="mapid" style="width: 300px; height: 300px;"></div>
</body>

<script>
//  $(window).ready(function () {
	 function getUrlVars()
	 {
	     var vars = [], hash;
	     var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
	     for(var i = 0; i < hashes.length; i++)
	     {
	         hash = hashes[i].split('=');
	         vars.push(hash[0]);
	         vars[hash[0]] = hash[1];
	     }
	     return vars;
	 }

 var loadVal = getUrlVars()["url"]
 console.log("loadVal URL " + loadVal);
 if (loadVal != null) {
   var url = decodeURIComponent(loadVal);
   console.log("value after decodeURIComponent " + url);
   rdfURL2SimpleArray(url).then( (data) => {
     let map = Map.constructorWithArray(mapid, data, "@id", "lat","long","label");
     console.log("Display all points for URL " + url);
     map.pinShowAll();
   })
 } else
     console.log("No url= in URL ");
 // })
</script>
